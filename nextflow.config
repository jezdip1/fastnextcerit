// ====== Kubernetes executor settings ======
k8s {
    namespace           = 'jezdik-ns'
    storageClaimName    = 'pvc-seg'
    storageMountPath    = '/mnt/data'
    workDir             = '/mnt/data/work'
    runAsUser           = 1000
    runAsGroup          = 1000
    fsGroup             = 1000
    fsGroupChangePolicy = 'OnRootMismatch'
    seccompProfile      = 'RuntimeDefault'
}

// ====== Globální executor config ======
executor {
    name      = 'k8s'
    queueSize = 5          // maximálně 5 podů najednou
}

// ====== Výchozí procesní nastavení ======
process {
    executor  = 'k8s'
    cpus      = 1
    memory    = '12 GB'
    container = 'jezdip1/fastsurfer-cerit:latest'
}

// ====== Label for GPU jobs ======
process {
    withLabel: 'gpu' {
        cpus      = 2
        memory    = '12 Gi'
        container = 'jezdip1/fastsurfer-cerit:latest'
        ext.k8s {
            requests = [ 'nvidia.com/gpu': '1', cpu: '2', memory: '10Gi' ]
            limits   = [ 'nvidia.com/gpu': '1', cpu: '2', memory: '12Gi' ]
        }
    }
}

// ====== Pipeline parameters ======
params {
    input_dir = '/mnt/data/input'
    out_dir   = '/mnt/data/subjects'
    license   = '/mnt/data/license.txt'
}
